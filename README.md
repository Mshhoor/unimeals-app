# 🍽️ منصة وجبتي - UniMeals Platform

منصة متطورة لتبادل الوجبات الجامعية مع نظام تسجيل الدخول الآمن والتقييمات المتقدمة.

## ✨ المميزات

- 🔑 **نظام تسجيل دخول متطور**: تسجيل بالبريد الإلكتروني وكلمة المرور
- 📱 **إدارة رقم الجوال**: ربط رقم الجوال بالحساب للتواصل مع المشترين
- 📱 **واجهة مستخدم متجاوبة**: تدعم الأجهزة المحمولة وأجهزة سطح المكتب
- ⭐ **نظام التقييمات**: تقييم البائعين لضمان الجودة
- 🔔 **إشعارات فورية**: تحديثات مباشرة عبر WebSocket
- 🌙 **الوضع الليلي**: واجهة مظلمة مريحة للعين
- 🚀 **سريع وموثوق**: بناء بتقنية Node.js وقاعدة بيانات SQLite
- 📊 **لوحة تحكم شاملة**: إدارة العروض والطلبات والإشعارات

## 🛠️ التقنيات المستخدمة

### Backend
- **Node.js** - بيئة تشغيل JavaScript
- **Express.js** - إطار عمل الويب
- **SQLite3** - قاعدة البيانات المحلية
- **Socket.IO** - التحديثات المباشرة
- **JWT** - المصادقة والتوكن
- **bcryptjs** - تشفير كلمات المرور

### Frontend
- **HTML5/CSS3** - البنية والتصميم
- **JavaScript (ES6+)** - المنطق والتفاعل
- **Socket.IO Client** - الاتصال المباشر
- **CSS Grid/Flexbox** - التخطيط المتجاوب

### الأمان والحماية
- **Helmet** - حماية HTTP Headers
- **CORS** - إدارة الطلبات من مصادر مختلفة
- **Rate Limiting** - حماية من الطلبات المتكررة
- **Input Validation** - التحقق من صحة البيانات

## 🚀 التثبيت والتشغيل

### المتطلبات
- Node.js (الإصدار 16.0 أو أعلى)
- npm أو yarn

### خطوات التثبيت

1. **استنساخ المشروع**
```bash
git clone <repository-url>
cd unimeals-app
```

2. **تثبيت الحزم**
```bash
npm install
```

3. **إعداد المتغيرات البيئية**
```bash
cp .env.example .env
# قم بتعديل الملف حسب بيئتك
```

4. **تهيئة قاعدة البيانات**
```bash
npm run init-db
```

5. **تشغيل الخادم**
```bash
# للتطوير
npm run dev

# للإنتاج
npm start
```

6. **فتح التطبيق**
```
http://localhost:3000
```

## 📁 هيكل المشروع

```
unimeals-app/
├── config/
│   └── database.js          # إعدادات قاعدة البيانات
├── routes/
│   ├── auth.js             # مسارات المصادقة والتحقق
│   ├── offers.js           # مسارات العروض
│   ├── ratings.js          # مسارات التقييمات
│   └── notifications.js    # مسارات الإشعارات
├── utils/
│   └── helpers.js          # دوال مساعدة
├── public/
│   ├── index.html          # الصفحة الرئيسية
│   ├── style.css           # ملفات التصميم
│   └── script.js           # منطق الواجهة الأمامية
├── scripts/
│   └── init-db.js          # سكريبت تهيئة قاعدة البيانات
├── data/
│   └── unimeals.db         # ملف قاعدة البيانات
├── server.js               # ملف الخادم الرئيسي
├── package.json            # معلومات المشروع والحزم
├── .env                    # متغيرات البيئة
└── README.md               # هذا الملف
```

## 🔧 API المتاح

### المصادقة وإدارة الحسابات
- `POST /api/auth/signup` - إنشاء حساب جديد
- `POST /api/auth/signin` - تسجيل الدخول
- `POST /api/auth/signout` - تسجيل الخروج
- `POST /api/auth/verify-token` - التحقق من صحة التوكن
- `POST /api/auth/add-phone` - إضافة/تحديث رقم الجوال
- `PUT /api/auth/update-profile` - تحديث الملف الشخصي
- `POST /api/auth/change-password` - تغيير كلمة المرور

### العروض
- `GET /api/offers` - جلب جميع العروض
- `POST /api/offers` - إضافة عرض جديد
- `GET /api/offers/my-offers` - جلب عروض البائع
- `GET /api/offers/reservations` - جلب الحجوزات
- `POST /api/offers/:key/reserve` - حجز وجبة
- `POST /api/offers/:key/confirm` - تأكيد الحجز
- `POST /api/offers/:key/reject` - رفض الحجز
- `DELETE /api/offers/:key` - حذف عرض

### التقييمات
- `POST /api/ratings` - إضافة تقييم
- `GET /api/ratings/seller/:sellerId` - جلب تقييمات بائع
- `POST /api/ratings/bulk-stats` - إحصائيات متعددة
- `GET /api/ratings/top-sellers` - أفضل البائعين

### الإشعارات
- `GET /api/notifications` - جلب الإشعارات
- `PUT /api/notifications/:id/read` - تحديد كمقروء
- `PUT /api/notifications/mark-all-read` - تحديد الكل كمقروء
- `DELETE /api/notifications/:id` - حذف إشعار

## 🔐 الأمان والحماية

### مميزات الأمان
- **JWT Tokens**: مصادقة آمنة بدون جلسات
- **Password Hashing**: تشفير كلمات المرور بـ bcrypt
- **Rate Limiting**: حماية من الهجمات المتكررة
- **Input Validation**: التحقق من صحة جميع البيانات
- **SQL Injection Protection**: استخدام Prepared Statements
- **XSS Protection**: تنظيف البيانات المدخلة
- **CORS Configuration**: إدارة الطلبات الخارجية

### نصائح أمنية للإنتاج
1. غير `JWT_SECRET` إلى قيمة قوية وعشوائية
2. غير `ADMIN_PASSWORD` إلى كلمة مرور قوية
3. فعّل HTTPS في الإنتاج
4. قم بتحديث جميع الحزم بانتظام
5. استخدم كلمات مرور قوية للحسابات
6. فعّل النسخ الاحتياطية لقاعدة البيانات

## 📱 استخدام المنصة

### للمستخدمين الجدد
1. **إنشاء حساب**: اختر "إنشاء حساب" وأدخل اسم المستخدم والبريد الإلكتروني وكلمة المرور
2. **تسجيل الدخول**: استخدم البريد الإلكتروني وكلمة المرور للدخول
3. **إضافة رقم الجوال**: أضف رقم جوالك من الملف الشخصي أو عند محاولة البيع

### للبائعين
1. **اختيار الدور**: اختر "أنا بائع" من الصفحة الرئيسية
2. **إضافة رقم الجوال**: أدخل رقم جوالك للتواصل مع المشترين (مطلوب للبيع)
3. **إضافة عرض**: أضف تفاصيل الوجبة والسعر
4. **إدارة الطلبات**: راجع واقبل/ارفض طلبات الحجز
5. **تتبع الوجبات**: راقب حالة جميع عروضك

### للمشترين
1. **اختيار الدور**: اختر "أنا مشتري" من الصفحة الرئيسية
2. **تصفح العروض**: شاهد جميع الوجبات المتاحة
3. **حجز وجبة**: احجز الوجبة المطلوبة
4. **تقييم البائع**: قيم تجربتك مع البائع
5. **التواصل**: تواصل مع البائع عبر واتساب بعد تأكيد الحجز

## 🌟 البيانات التجريبية

بعد تشغيل `npm run init-db`، ستحصل على:

### 👥 مستخدمين تجريبيين:
| الاسم | البريد الإلكتروني | الجوال | كلمة المرور |
|-------|------------------|--------|-------------|
| أحمد_محمد | ahmed@example.com | 0512345678 | 123456 |
| فاطمة_علي | fatima@example.com | 0587654321 | 123456 |
| محمد_السالم | mohammed@example.com | 0501234567 | 123456 |
| نورا_أحمد | nora@example.com | 0559876543 | 123456 |
| عبدالله_الخالد | abdullah@example.com | 0566789012 | 123456 |

### 🍽️ عروض تجريبية:
- وجبات فطور وغداء وعشاء متنوعة
- حالات مختلفة (متاح، محجوز، مباع)
- تقييمات وإشعارات تجريبية

### 🔐 تسجيل الدخول:
- استخدم أي بريد إلكتروني من الجدول أعلاه
- كلمة المرور لجميع الحسابات: `123456`
- رقم الجوال مربوط مسبقاً لكل حساب

## 🚀 التطوير

### تشغيل في وضع التطوير
```bash
npm run dev
```

### البناء للإنتاج
```bash
# تأكد من تحديث المتغيرات في .env
NODE_ENV=production npm start
```

### اختبار API
```bash
# فحص حالة الخادم
curl http://localhost:3000/api/health

# جلب العروض
curl http://localhost:3000/api/offers
```

## 🐛 استكشاف الأخطاء

### مشاكل شائعة وحلولها

1. **خطأ في الاتصال بقاعدة البيانات**
   ```bash
   # احذف قاعدة البيانات وأعد إنشاؤها
   rm data/unimeals.db
   npm run init-db
   ```

2. **Port مستخدم بالفعل**
   ```bash
   # غير المنفذ في .env
   PORT=3001
   ```

3. **مشاكل في التحقق من SMS**
   - في بيئة التطوير، الكود سيظهر في الكونسول
   - تأكد من أن رقم الجوال يبدأ بـ 05

4. **مشاكل في Socket.IO**
   - تأكد من أن المتصفح يدعم WebSocket
   - تحقق من إعدادات الجدار الناري

## 🤝 المساهمة

نرحب بالمساهمات! يرجى:

1. Fork المشروع
2. إنشاء branch جديد للميزة
3. Commit التغييرات
4. Push إلى branch
5. فتح Pull Request

## 📄 الترخيص

هذا المشروع مرخص تحت رخصة MIT - راجع ملف [LICENSE](LICENSE) للتفاصيل.

## 📞 الدعم والتواصل

- **المشاكل التقنية**: افتح Issue في GitHub
- **الاقتراحات**: ارسل Pull Request
- **الدعم العام**: تواصل معنا عبر البريد الإلكتروني

## 🙏 شكر وتقدير

شكراً لجميع المساهمين والمطورين الذين ساعدوا في تطوير هذا المشروع.

## 🔄 التغييرات الحديثة في النسخة 2.0

### ✨ ما الجديد:
- **نظام تسجيل دخول جديد**: استبدال التحقق من الجوال بنظام تسجيل دخول تقليدي
- **إدارة الحسابات**: إنشاء حساب بالبريد الإلكتروني وكلمة المرور
- **ربط رقم الجوال**: إضافة رقم الجوال اختيارياً للبائعين فقط
- **تحسينات الأمان**: تشفير كلمات المرور وتحسين نظام المصادقة
- **واجهة محسنة**: تصميم أفضل لتسجيل الدخول والملف الشخصي

### 🔧 كيفية الاستخدام:
1. **للمستخدمين الجدد**: إنشاء حساب جديد بالبريد وكلمة المرور
2. **للبائعين**: إضافة رقم الجوال عند محاولة البيع أول مرة
3. **للمشترين**: لا يحتاجون رقم جوال، فقط الحساب للتصفح والشراء

---

💡 **ملاحظة**: هذا المشروع تعليمي وغير مخصص للاستخدام التجاري المباشر. يرجى إضافة المزيد من ميزات الأمان قبل النشر في الإنتاج.

🚀 **ابدأ الآن**: `npm install && npm run init-db && npm start`